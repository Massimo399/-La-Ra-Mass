<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>À La Ra'Mass — Cours de natation à Charleroi</title>
  <meta name="description" content="À La Ra'Mass — Cours de natation privés pour enfants et adolescents autour de Charleroi (~15 km). Réservation en ligne, créneaux de 30 minutes, 25€ la séance (entrée piscine incluse)." />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- === SEO de base === -->
  <!-- Remplace l'URL si tu renommes ton dépôt ou utilises un domaine personnalisé -->
  <link rel="canonical" href="https://massimo399.github.io/-La-Ra-Mass/">
  <meta name="robots" content="index,follow">

  <!-- === Open Graph / Social === -->
  <meta property="og:title" content="À La Ra'Mass — Cours de natation à Charleroi">
  <meta property="og:description" content="À La Ra'Mass — Cours de natation privés pour enfants et adolescents autour de Charleroi (~15 km). Réservation en ligne, créneaux de 30 minutes, 25€ la séance (entrée piscine incluse).">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://massimo399.github.io/-La-Ra-Mass/">
  <meta property="og:site_name" content="À La Ra'Mass">
  <meta property="og:locale" content="fr_BE">
  <!-- <meta property="og:image" content="https://massimo399.github.io/-La-Ra-Mass/visuel.jpg"> -->

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="À La Ra'Mass — Cours de natation à Charleroi">
  <meta name="twitter:description" content="Cours privés pour enfants & ados (~15 km de Charleroi). Réservation en ligne, 25 € la séance.">
  <!-- <meta name="twitter:image" content="https://massimo399.github.io/-La-Ra-Mass/visuel.jpg"> -->

  <!-- === JSON-LD LocalBusiness === -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": ["LocalBusiness","SportsActivityLocation"],
    "name": "À La Ra'Mass",
    "alternateName": ["A La Ra Mass","A La Ra'Mass","À La Ra Mass","À La Ra'Mass"],
    "url": "https://massimo399.github.io/-La-Ra-Mass/",
    "areaServed": "Charleroi (~15 km)",
    "priceRange": "€€",
    "email": "pasetti.massimo@hotmail.com",
    "telephone": "+32 479 87 94 46",
    "description": "Cours privés de natation pour enfants et adolescents autour de Charleroi. Créneaux de 30 minutes, pédagogie bienveillante, 25 € la séance (entrée piscine incluse)."
  }
  </script>
  <!-- Si Search Console te donne une balise de vérification, colle-la ici (avant </head>) -->

  <style>
    :root{ --blue:#0ea5e9; --blue-dark:#0369a1; --ink:#0b1220; --bg:#f8fafc; --card:#ffffff; --accent:#22d3ee; }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;color:#0f172a;background:var(--bg)}
    a{color:var(--blue-dark);text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1100px;margin:0 auto;padding:0 20px}

    header{position:sticky;top:0;z-index:1000;background:linear-gradient(180deg, rgba(2,132,199,0.95), rgba(14,165,233,0.95));backdrop-filter:saturate(120%) blur(6px);color:white;box-shadow:0 4px 14px rgba(0,0,0,.15)}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .brand{display:flex;align-items:center;gap:12px}
    .brand .logo{width:40px;height:40px;border-radius:12px;display:grid;place-items:center;background:#e0f2fe;box-shadow:inset 0 0 18px rgba(255,255,255,.35)}
    .brand .logo svg{width:26px;height:26px;fill:#0369a1}
    .brand h1{font-size:1.1rem;margin:0;letter-spacing:.3px}
    nav ul{list-style:none;display:flex;gap:18px;margin:0;padding:0}
    nav a{color:white;font-weight:600}

    .hero{position:relative;overflow:hidden;background:linear-gradient(180deg,#e0f2fe 0%, #f0fdff 100%)}
    .hero .inner{display:grid;grid-template-columns:1.2fr .8fr;gap:28px;align-items:center;padding:48px 0;position:relative;z-index:2}
    .hero h2{font-size:2.2rem;margin:.2rem 0;color:#0b1220}
    .hero p{margin:0 0 18px;color:#334155}
    .cta{display:flex;gap:12px;flex-wrap:wrap}

    .btn{appearance:none;border:0;border-radius:14px;padding:12px 16px;font-weight:700;cursor:pointer;transition:.2s ease box-shadow, .2s ease transform}
    .btn-primary{background:var(--blue);color:white;box-shadow:0 8px 20px rgba(14,165,233,.35)}
    .btn-primary:hover{transform:translateY(-1px);box-shadow:0 12px 28px rgba(14,165,233,.45)}
    .btn-outline{background:transparent;color:var(--blue-dark);border:2px solid var(--blue-dark)}

    .hero-art{position:relative;height:260px;border-radius:18px;background:linear-gradient(145deg,#0ea5e9,#22d3ee);box-shadow:0 12px 34px rgba(2,132,199,.25);overflow:hidden;display:grid;place-items:center}
    .hero-art svg{width:85%;height:auto;max-width:420px;opacity:.95}

    .aquarium{position:fixed;inset:0;overflow:hidden;pointer-events:none;z-index:1}
    .bubble-fx{position:absolute;bottom:-120px;border-radius:50%;opacity:.35;filter:blur(0.5px);animation:rise var(--dur) linear infinite;left:var(--x);width:var(--s);height:var(--s);background:radial-gradient(circle at 30% 30%,rgba(255,255,255,.9),rgba(255,255,255,.45) 40%,rgba(255,255,255,.1) 60%,transparent 70%)}
    .bubble-fx::after{content:"";position:absolute;inset:0;border-radius:50%;box-shadow:inset -6px -8px 18px rgba(2,132,199,.25)}
    @keyframes rise{0%{transform:translateY(0) translateX(0)} 100%{transform:translateY(-120vh) translateX(var(--dx,0))}}

    section{padding:56px 0;position:relative;z-index:2}
    .card{background:var(--card);border-radius:18px;box-shadow:0 10px 24px rgba(2,6,23,.08);padding:22px}
    .grid{display:grid;gap:18px}
    .grid-2{grid-template-columns:1fr 1fr}
    .h{margin:0 0 14px}
    h3.h{font-size:1.6rem}
    .pill{display:inline-block;background:#e0f2fe;color:#075985;border-radius:999px;padding:6px 12px;font-size:.9rem;font-weight:700}
    .list{margin:0;padding-left:18px;color:#334155}
    .note{font-size:.95rem;color:#334155;background:#f1f5f9;border-left:4px solid var(--blue);padding:12px 14px;border-radius:12px}

    .planning-controls{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-bottom:12px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{border:1px solid #cbd5e1;background:#fff;color:#0b1220;border-radius:12px;padding:8px 12px;cursor:pointer;font-weight:700}
    .tab.active{background:var(--blue);color:white;border-color:var(--blue)}
    .slots{display:grid;grid-template-columns:repeat(auto-fill,minmax(165px,1fr));gap:10px}
    .slot{padding:10px;border:1px solid #e2e8f0;border-radius:12px;background:#fff;text-align:center;cursor:pointer;font-weight:700}
    .slot small{display:block;font-weight:600;color:#475569}
    .slot:hover{border-color:var(--blue)}
    .slot.booked{opacity:.5;cursor:not-allowed;text-decoration:line-through}
    .slot.selected{outline:3px solid var(--accent)}
    .switch{display:inline-flex;align-items:center;gap:8px}
    .switch input{accent-color:var(--blue)}
    .form{display:grid;gap:12px}
    .form input, .form select, .form textarea{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #cbd5e1;font:inherit}
    .form .row{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    .success{display:none;margin-top:8px;padding:10px;border-radius:12px;background:#dcfce7;border:1px solid #86efac;color:#14532d;font-weight:700}
    .badge{display:inline-block;margin-left:6px;padding:2px 8px;border-radius:999px;background:#ecfeff;color:#0e7490;border:1px solid #a5f3fc;font-size:.8rem}

    .pricing{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .price-card{position:relative;padding:22px;border-radius:18px;background:#ffffff;border:1px solid #e2e8f0;box-shadow:0 6px 18px rgba(2,6,23,.06)}
    .price{font-size:2rem;margin:8px 0 0}
    .small{font-size:.95rem;color:#334155}
    .strike{color:#475569;text-decoration:line-through}

    footer{padding:32px 0;background:#0b1220;color:#e2e8f0;position:relative;z-index:2}
    footer a{color:#7dd3fc}

    @media (max-width: 900px){ .hero .inner{grid-template-columns:1fr} .grid-2{grid-template-columns:1fr} .pricing{grid-template-columns:1fr} .form .row{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <div class="aquarium" aria-hidden="true" id="aquarium"></div>

  <header>
    <div class="container nav">
      <div class="brand">
        <div class="logo" aria-hidden="true" title="Accueil">
          <svg viewBox="0 0 24 24" role="img" aria-label="Nageur"><path d="M7.5 5.75a1.75 1.75 0 1 1 3.499 0A1.75 1.75 0 0 1 7.5 5.75zm8.75 5.25-3.3-1.9a2.5 2.5 0 0 0-2.46.04l-2.97 1.8a.75.75 0 0 0 .78 1.29l2.94-1.78c.4-.24.9-.25 1.31-.02l2.45 1.41-3.67 2.13a2.5 2.5 0 0 1-2.47 0l-2.3-1.33a.75.75 0 1 0-.74 1.3l2.3 1.33a4 4 0 0 0 3.95 0l4.98-2.89.77.44a3.5 3.5 0 0 0 3.5 0 .75.75 0 0 0-.75-1.3 2 2 0 0 1-2 0l-1.89-1.1zM3 18.25c.7.44 1.55.75 2.5.75s1.8-.31 2.5-.75c.7.44 1.55.75 2.5.75s1.8-.31 2.5-.75c.7.44 1.55.75 2.5.75s1.8-.31 2.5-.75c.7.44 1.55.75 2.5.75a.75.75 0 0 0 0-1.5c-.95 0-1.8-.31-2.5-.75-.7.44-1.55.75-2.5.75s-1.8-.31-2.5-.75c-.7.44-1.55.75-2.5.75s-1.8-.31-2.5-.75c-.7.44-1.55.75-2.5.75s-1.8-.31-2.5-.75a.75.75 0 1 0 0 1.5z"/></svg>
        </div>
        <h1>À La Ra'Mass</h1>
      </div>
      <nav>
        <ul>
          <li><a href="#accueil">Accueil</a></li>
          <li><a href="#presentation">Présentation</a></li>
          <li><a href="#planning">Planning & Réservation</a></li>
          <li><a href="#tarifs">Tarifs</a></li>
          <li><a href="#contact">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="accueil" class="hero">
    <div class="container inner">
      <div>
        <span class="pill">Natation • Charleroi et alentours (~15 km)</span>
        <h2>Perfectionnez la technique de vos enfants en toute confiance</h2>
        <p>Leçons privées de 30 minutes pour enfants & adolescents — pédagogie positive, progression mesurable, et bonne humeur garantie. Réservez en quelques clics.</p>
        <div class="cta">
          <a class="btn btn-primary" href="#planning">Réserver un créneau</a>
          <a class="btn btn-outline" href="#presentation">Rencontrer Massimo</a>
        </div>
      </div>
      <div class="hero-art" aria-hidden="true">
        <!-- Illustration nageur (en haut à droite) -->
        <svg viewBox="0 0 512 512" role="img" aria-label="Illustration nageur" xmlns="http://www.w3.org/2000/svg">
          <path fill="#e0f2fe" d="M0 400c40-20 80-20 120 0s80 20 120 0 80-20 120 0 80 20 120 0v64H0z"/>
          <circle cx="210" cy="120" r="26" fill="#fef3c7"/>
          <path fill="#f0f9ff" d="M120 200l80-40 80 48 48 16-48 24-64-16-64 24z"/>
          <path fill="#bae6fd" d="M64 320c40-24 80-24 120 0s80 24 120 0 80-24 120 0" stroke="#7dd3fc" stroke-width="12" fill="none"/>
        </svg>
      </div>
    </div>
  </main>

  <section id="presentation">
    <div class="container grid grid-2">
      <div class="card">
        <h3 class="h">Massimo — Coach de natation</h3>
        <p>Moi c'est <strong>Massimo</strong>, 25 ans. J'ai étudié dans le domaine du <strong>sport</strong> et je suis également <strong>animateur</strong>. J'accorde une grande importance à l'écoute, à la <strong>bienveillance</strong> et à la <strong>bonne humeur</strong> pour créer un cadre motivant et sécurisant.</p>
        <ul class="list">
          <li>Accompagnement sur-mesure (débutant à perfectionnement)</li>
          <li>Focus technique : respiration, battements, alignement, virages</li>
          <li>Feedback clair à chaque séance</li>
          <li>Possible dans la <strong>piscine de votre choix</strong> autour de <strong>Charleroi</strong> (~15 km : Farciennes, Châtelet, Fleurus, Courcelles, Montigny‑le‑Tilleul...)</li>
        </ul>
        <div class="note" style="margin-top:12px">Chaque créneau dure <strong>30 minutes</strong>. Zone d’intervention : Charleroi et alentours (~15 km).</div>
      </div>
      <div class="card">
        <h4 class="h">Objectifs des séances</h4>
        <ul class="list">
          <li>Développer l'aisance aquatique et la confiance</li>
          <li>Améliorer l'efficacité des quatre nages</li>
          <li>Corriger les défauts techniques avec des exercices ciblés</li>
          <li>Préparer tests, compétitions ou certificats de nage</li>
        </ul>
      </div>
    </div>
  </section>

  <section id="planning">
    <div class="container">
      <div class="card">
        <div class="planning-controls">
          <h3 class="h" style="margin:0">Planning & Réservation <span title="Arrivez 10 min à l'avance">*</span></h3>
          <span class="badge">Entrée piscine incluse</span>
        </div>
        <p class="small">Créneaux de <strong>30 minutes</strong>* — horaires auto‑calculés selon la <strong>piscine choisie</strong> (ouverture/fermeture officielles). <strong>Samedi</strong> et <strong>dimanche</strong> selon disponibilités de chaque piscine.</p>
        <p class="small">* Merci d'être présent(e) au moins <strong>10 minutes à l'avance</strong> pour l'accueil et la préparation.</p>

        <div class="planning-controls">
          <label style="font-weight:700">Choisir une piscine&nbsp;:</label>
          <select id="poolSelect" class="tab" style="min-width:300px">
            <option value="helios">Piscine Hélios — Gilly (Charleroi)</option>
            <option value="sirena">Siréna — Châtelet/Farciennes</option>
            <option value="fleurus">Piscine communale — Fleurus</option>
            <option value="fontaine">Piscine — Fontaine‑l'Évêque</option>
            <option value="courcelles">Piscine Hissého — Courcelles</option>
            <option value="charleroi_bains">Charleroi‑les‑Bains (extérieur, saison)</option>
          </select>
          <div id="periodWrap" style="display:none;align-items:center;gap:8px">
            <label for="periodSelect">Période&nbsp;:</label>
            <select id="periodSelect" class="tab">
              <option value="scolaire">Période scolaire</option>
              <option value="conges">Congés scolaires</option>
            </select>
          </div>
        </div>

        <div class="planning-controls">
          <div class="tabs" role="tablist" aria-label="Jours de la semaine">
            <button class="tab active" data-day="1">Lun</button>
            <button class="tab" data-day="2">Mar</button>
            <button class="tab" data-day="3">Mer</button>
            <button class="tab" data-day="4">Jeu</button>
            <button class="tab" data-day="5">Ven</button>
            <button class="tab" data-day="6">Sam</button>
            <button class="tab" data-day="0">Dim</button>
          </div>
          <label class="switch" title="Certaines piscines ouvrent plus tard">
            <input type="checkbox" id="extendWeek"> Étendre le soir (jamais au‑delà des horaires officiels)
          </label>
        </div>

        <div class="slots" id="slots" aria-live="polite"></div>

        <hr style="border:none;border-top:1px solid #e2e8f0;margin:16px 0">

        <form class="form" id="bookingForm">
          <h4 class="h">Finaliser la réservation</h4>
          <div class="row">
            <div><label>Nom & Prénom</label><input required type="text" id="name" placeholder="Votre nom" /></div>
            <div><label>Email</label><input required type="email" id="email" placeholder="vous@exemple.com" /></div>
          </div>
          <div class="row">
            <div><label>Téléphone</label><input required type="tel" id="phone" placeholder="+32 ..." /></div>
            <div>
              <label>Piscine souhaitée</label>
              <input list="pools" required type="text" id="pool" placeholder="Ex: Piscine Hélios, Gilly" />
              <datalist id="pools">
                <option value="Piscine Hélios — Gilly (Charleroi)"></option>
                <option value="Siréna — Châtelet/Farciennes"></option>
                <option value="Piscine Communale — Fleurus"></option>
                <option value="Piscine — Fontaine‑l'Évêque"></option>
                <option value="Piscine Hissého — Courcelles"></option>
                <option value="Charleroi‑les‑Bains (extérieur)"></option>
              </datalist>
            </div>
          </div>
          <div><label>Créneau choisi</label><input type="text" id="chosenSlot" readonly placeholder="Cliquez un créneau ci-dessus" /></div>
          <div><label>Remarques</label><textarea id="notes" rows="3" placeholder="Objectifs, niveau, besoins spécifiques..."></textarea></div>
          <div class="row">
            <button type="submit" class="btn btn-primary">Réserver & enregistrer</button>
            <button type="button" class="btn btn-outline" id="dlIcs" disabled>Télécharger .ics</button>
            <button type="button" class="btn btn-primary" id="payNow">Payer maintenant</button>
          </div>
          <div class="success" id="successMsg">Réservation enregistrée ! Vous pouvez télécharger l'évènement (.ics), payer en ligne et/ou envoyer une demande de confirmation par email.</div>
          <p class="small">Besoin d'une confirmation écrite ? <a id="mailtoLink" href="#" aria-disabled="true">Envoyer une demande par email</a></p>
        </form>

        <p class="small" style="margin-top:16px;color:#475569">⚠️ Les horaires sont issus des sites officiels et peuvent varier (vacances, maintenance). * Arrivez 10 min à l'avance.</p>
      </div>
    </div>
  </section>

  <section id="tarifs">
    <div class="container">
      <h3 class="h">Tarifs</h3>
      <div class="pricing">
        <div class="price-card"><div class="pill">Séance à l'unité</div><p class="price">25 €</p><p class="small">Durée : 30 minutes — <strong>entrée piscine incluse</strong>.</p></div>
        <div class="price-card"><div class="pill">Forfait 10 séances</div><p class="small"><span class="strike">250 €</span></p><p class="price">212,50 €</p><p class="small">Remise <strong>15%</strong> incluse (soit <strong>−37,50 €</strong>), valable pour 10 créneaux de 30 minutes.</p></div>
      </div>
      <div class="note" style="margin-top:12px">Le tarif inclut l'<strong>entrée à la piscine</strong>. Des frais de déplacement peuvent s'appliquer selon la distance.</div>
    </div>
  </section>

  <section id="contact">
    <div class="container grid grid-2">
      <div class="card">
        <h3 class="h">Contact</h3>
        <p>Email : <a href="mailto:pasetti.massimo@hotmail.com">pasetti.massimo@hotmail.com</a><br> Téléphone : <a href="tel:+32479879446">+32 479 87 94 46</a></p>
        <p class="small">Interventions dans les <strong>piscines de votre choix</strong> autour de <strong>Charleroi</strong> (~15 km&nbsp;: Farciennes, Châtelet, Fleurus, Courcelles, Montigny‑le‑Tilleul, Fontaine‑l’Évêque…).</p>
      </div>
      <div class="card">
        <h4 class="h">Raccourcis</h4>
        <p>
          <a class="btn btn-outline" href="#planning">Aller au planning</a>
          <a class="btn btn-outline" href="#tarifs">Voir les tarifs</a>
          <a class="btn btn-outline" href="#presentation">Présentation</a>
        </p>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <div style="display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;align-items:center">
        <p style="margin:0">© <span id="year"></span> À La Ra'Mass — Massimo</p>
        <p style="margin:0;font-size:.95rem">RGPD : données de réservation stockées localement sur votre appareil uniquement.</p>
      </div>
    </div>
  </footer>

  <script>
    const fmt2 = n => n.toString().padStart(2,'0');
    const dayNames = ["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"];
    const dayNamesShort = ["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"];

    // Horaires (0=Dim .. 6=Sam). Certaines piscines ont 2 périodes (scolaire / congés).
    const POOLS = {
      helios: { name: 'Piscine Hélios — Gilly (Charleroi)', stable:false, notice:'Horaires susceptibles de varier — vérifiez le site officiel.', hours: {
        1:[['07:00','18:30']], 2:[['07:00','18:30']], 3:[['07:00','18:30']], 4:[['07:00','18:30']], 5:[['07:00','18:30']], 6:[['10:00','14:00'],['14:30','18:30']], 0:[['08:30','13:00']]
      }},
      sirena: { name: 'Siréna — Châtelet/Farciennes (période scolaire)', stable:false, notice:'Horaires susceptibles de varier — vérifiez le site officiel.', hours: {
        1:[['12:00','13:30'],['16:00','19:30']], 2:[['07:00','08:30'],['12:00','13:30'],['16:00','21:30']], 3:[['12:00','19:30']], 4:[['12:00','13:30'],['16:00','19:30']], 5:[['12:00','13:30'],['16:00','21:30']], 6:[['10:30','13:00'],['14:00','18:00']], 0:[['09:00','13:30']]
      }},
      fleurus: { name: 'Piscine communale — Fleurus', stable:false, notice:'Horaires susceptibles de varier — vérifiez le site officiel.', hours: {
        1:[['07:00','08:30'],['11:45','13:15'],['15:30','19:15']], 2:[['07:00','09:00'],['11:45','13:15'],['15:30','19:40']], 3:[['07:00','09:00'],['12:00','19:40']], 4:[['07:00','08:30'],['11:45','13:15'],['15:30','19:15']], 5:[['07:00','08:30'],['11:45','13:15'],['15:30','19:15']], 6:[['10:00','18:40']], 0:[['08:00','12:40']]
      }},
      fontaine: { name: 'Piscine — Fontaine‑l\'Évêque', stable:true, periods: {
        scolaire: { hours: {1:[['15:15','16:30']],2:[['15:15','18:45']],3:[['15:15','18:45']],4:[['15:15','18:45']],5:[['15:15','20:45']],6:[['14:00','18:45']],0:[['09:00','15:30']] } },
        conges:   { hours: {1:[['13:00','18:45']],2:[['13:00','18:45']],3:[['13:00','18:45']],4:[['13:00','18:45']],5:[['13:00','20:45']],6:[['13:00','18:45']],0:[['09:00','12:30']] } }
      }, notice:'Horaires confirmés. Vérifiez les annonces municipales en cas d\'exception.'},
      courcelles: { name: 'Piscine Hissého — Courcelles', stable:true, periods: {
        scolaire: { hours: {1:[['11:45','13:30'],['15:30','19:00']],2:[['07:00','08:30'],['11:45','13:30'],['15:30','19:00']],3:[['11:45','20:00']],4:[['07:00','08:30'],['11:45','13:30'],['15:30','19:00']],5:[['07:00','08:30'],['11:45','13:30'],['15:30','19:00']],6:[['10:00','13:00'],['14:00','17:30']],0:[['08:30','12:30']] } },
        conges: { hours: {1:[['10:00','13:00'],['14:00','19:00']],2:[['10:00','13:00'],['14:00','19:00']],3:[['10:00','13:00'],['14:00','20:00']],4:[['10:00','13:00'],['14:00','19:00']],5:[['10:00','13:00'],['14:00','19:00']],6:[['10:00','13:00'],['14:00','17:30']],0:[['08:30','12:30']] } }
      }, notice:"Dernière entrée 40 min avant la fermeture. Sortie de l'eau 15 min avant."},
      charleroi_bains: { name: 'Charleroi‑les‑Bains (extérieur, saison)', stable:false, hours: {
        1:[['10:00','14:00'],['14:30','18:30']], 2:[['10:00','14:00'],['14:30','18:30']], 3:[['10:00','14:00'],['14:30','18:30']], 4:[['10:00','14:00'],['14:30','18:30']], 5:[['10:00','14:00'],['14:30','18:30']], 6:[['10:00','14:00'],['14:30','18:30']], 0:[['10:00','14:00'],['14:30','18:30']]
      }, notice:'Ouverture saisonnière selon météo — à confirmer.'}
    };

    let currentPool = 'helios';
    let currentPeriod = 'scolaire';

    const SLOT_MIN = 30;
    const slotsEl = document.getElementById('slots');
    const extendWeek = document.getElementById('extendWeek');
    const periodWrap = document.getElementById('periodWrap');

    const LS_KEY = 'alamass_bookings_live';
    const loadBookings = () => JSON.parse(localStorage.getItem(LS_KEY)||'{}');
    const saveBookings = (obj) => localStorage.setItem(LS_KEY, JSON.stringify(obj));

    function getIntervals(poolKey, weekday){
      const pool = POOLS[poolKey];
      if(!pool) return [];
      if(pool.periods){
        const p = pool.periods[currentPeriod] || {hours:{}};
        return p.hours[weekday] || [];
      }
      return (pool.hours?.[weekday]) || [];
    }

    function buildSlots(weekdayIndex){
      slotsEl.innerHTML = '';
      const pool = POOLS[currentPool];
      if(!pool) return;

      periodWrap.style.display = pool.periods ? 'flex' : 'none';

      // Notices
      if(pool.notice){
        const info = document.createElement('div'); info.className='note'; info.textContent = pool.notice; slotsEl.appendChild(info);
      }

      const now = new Date();
      const delta = (weekdayIndex - now.getDay() + 7) % 7;
      const baseDate = new Date(now); baseDate.setDate(now.getDate() + delta);
      const intervals = getIntervals(currentPool, weekdayIndex);
      if(!intervals.length){
        const msg = document.createElement('div'); msg.className='note'; msg.textContent = 'Piscine fermée / non disponible ce jour.'; slotsEl.appendChild(msg); return;
      }

      const bookings = loadBookings();
      const dayNum = baseDate.getDate();
      const dayLabel = `${dayNamesShort[weekdayIndex]} ${dayNum}`;

      const addRange = (start,end)=>{
        const [sh,sm] = start.split(':').map(Number);
        const [eh,em] = end.split(':').map(Number);
        let cursor = new Date(baseDate.getFullYear(), baseDate.getMonth(), baseDate.getDate(), sh, sm);
        let endDate = new Date(baseDate.getFullYear(), baseDate.getMonth(), baseDate.getDate(), eh, em);

        // Hissého: sortie de l'eau 15 min avant la fermeture
        if(currentPool==='courcelles'){
          endDate = new Date(endDate.getTime() - 15*60000);
        }
        // Option "étendre le soir", mais jamais au-delà de 20:30
        if(extendWeek.checked){
          endDate.setHours(Math.min(endDate.getHours(),20), Math.min(endDate.getMinutes(),30));
        }

        // Masquer toutes les plages avant 15:00 en semaine (lundi→vendredi). Week‑end autorisé.
        const isWeekend = (weekdayIndex === 6 || weekdayIndex === 0); // 6=Sam, 0=Dim
        if(!isWeekend){
          const minStart = new Date(baseDate.getFullYear(), baseDate.getMonth(), baseDate.getDate(), 15, 0);
          if(cursor < minStart) cursor = new Date(minStart);
          if(cursor >= endDate) return;
        }

        while(cursor < endDate){
          const next = new Date(cursor.getTime() + SLOT_MIN*60000);
          if(next> endDate) break;
          const timeLabel = `${fmt2(cursor.getHours())}:${fmt2(cursor.getMinutes())}–${fmt2(next.getHours())}:${fmt2(next.getMinutes())}`;
          const label = `${dayLabel} • ${timeLabel}`;
          const slotId = `${baseDate.toDateString()}_${currentPool}_${currentPeriod}_${timeLabel}`;
          const btn = document.createElement('button');
          btn.type='button'; btn.className='slot';
          btn.innerHTML = `${label} <small>* 10 min d'avance</small>`;
          const sIso = new Date(baseDate.getFullYear(), baseDate.getMonth(), baseDate.getDate(), cursor.getHours(), cursor.getMinutes()).toISOString();
          const eIso = new Date(baseDate.getFullYear(), baseDate.getMonth(), baseDate.getDate(), next.getHours(), next.getMinutes()).toISOString();
          btn.dataset.slotId = slotId; btn.dataset.isoStart=sIso; btn.dataset.isoEnd=eIso;
          if(bookings[slotId]){ btn.classList.add('booked'); btn.disabled = true; btn.title='Déjà réservé'; }
          btn.addEventListener('click',()=> selectSlot(btn));
          slotsEl.appendChild(btn);
          cursor = next;
        }
      };

      intervals.forEach(([s,e])=> addRange(s,e));

      // Bloquer les créneaux déjà passés si on regarde "aujourd'hui"
      if(delta===0){
        Array.from(slotsEl.children).forEach(ch=>{
          const st = new Date(ch.dataset?.isoStart||0);
          if(st && st < now){ ch.classList.add('booked'); ch.disabled = true; ch.title='Créneau dépassé'; }
        });
      }
    }

    // Sélecteurs et champs
    const poolField = document.getElementById('pool');
    const poolSelect = document.getElementById('poolSelect');
    if(poolSelect){
      poolSelect.addEventListener('change', ()=>{
        currentPool = poolSelect.value;
        if(poolField){ poolField.value = POOLS[currentPool]?.name || ''; }
        const active = document.querySelector('.tab.active');
        buildSlots(parseInt(active.dataset.day,10));
      });
      if(poolField){ poolField.value = POOLS[currentPool]?.name || ''; }
    }

    const periodSelect = document.getElementById('periodSelect');
    if(periodSelect){
      periodSelect.addEventListener('change', ()=>{
        currentPeriod = periodSelect.value;
        const active = document.querySelector('.tab.active');
        buildSlots(parseInt(active.dataset.day,10));
      });
    }

    const chosenSlotInput = document.getElementById('chosenSlot');
    const form = document.getElementById('bookingForm');
    const success = document.getElementById('successMsg');
    const dlIcsBtn = document.getElementById('dlIcs');
    const mailtoLink = document.getElementById('mailtoLink');

    function selectSlot(el){
      document.querySelectorAll('.slot.selected').forEach(s => s.classList.remove('selected'));
      el.classList.add('selected');
      const d = new Date(el.dataset.isoStart); const de = new Date(el.dataset.isoEnd);
      const nice = `${dayNames[d.getDay()]} ${fmt2(d.getDate())}/${fmt2(d.getMonth()+1)}/${d.getFullYear()} • ${fmt2(d.getHours())}h${fmt2(d.getMinutes())}–${fmt2(de.getHours())}h${fmt2(de.getMinutes())}`;
      chosenSlotInput.value = nice + " * arriver 10 min à l'avance";
      chosenSlotInput.dataset.slotId = el.dataset.slotId;
      chosenSlotInput.dataset.isoStart = el.dataset.isoStart;
      chosenSlotInput.dataset.isoEnd = el.dataset.isoEnd;
    }

    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      if(!chosenSlotInput.dataset.slotId){ alert('Merci de sélectionner un créneau.'); return; }
      const data = {
        name: document.getElementById('name').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        pool: document.getElementById('pool').value.trim(),
        notes: document.getElementById('notes').value.trim(),
        slotId: chosenSlotInput.dataset.slotId,
        start: chosenSlotInput.dataset.isoStart,
        end: chosenSlotInput.dataset.isoEnd,
      };
      const bookings = loadBookings();
      if(bookings[data.slotId]){ alert('Ce créneau est déjà réservé sur cet appareil.'); return; }
      bookings[data.slotId] = data; saveBookings(bookings);
      success.style.display = 'block'; dlIcsBtn.disabled = false;
      const active = document.querySelector('.slot.selected');
      if(active){ active.classList.remove('selected'); active.classList.add('booked'); active.disabled = true; }

      const d = new Date(data.start); const de = new Date(data.end);
      const subject = encodeURIComponent(`Demande de confirmation — ${fmt2(d.getDate())}/${fmt2(d.getMonth()+1)} ${fmt2(d.getHours())}h${fmt2(d.getMinutes())}`);
      const body = encodeURIComponent(`Bonjour Massimo,

Je viens de réserver un créneau via le site.

Nom: ${data.name}
Téléphone: ${data.phone}
Email: ${data.email}
Piscine souhaitée: ${data.pool}
Créneau: ${dayNames[d.getDay()]} ${fmt2(d.getDate())}/${fmt2(d.getMonth()+1)}/${d.getFullYear()} de ${fmt2(d.getHours())}h${fmt2(d.getMinutes())} à ${fmt2(de.getHours())}h${fmt2(de.getMinutes())}
Remarques: ${data.notes || '-'}

* J'ai bien pris note d'arriver 10 minutes à l'avance.

Pouvez-vous me confirmer la disponibilité ? Merci !`);
      mailtoLink.href = `mailto:pasetti.massimo@hotmail.com?subject=${subject}&body=${body}`;
      mailtoLink.removeAttribute('aria-disabled');
    });

    function toICS(data){
      const s = new Date(data.start); const e = new Date(data.end);
      const dt = `${s.getFullYear()}${fmt2(s.getMonth()+1)}${fmt2(s.getDate())}T${fmt2(s.getHours())}${fmt2(s.getMinutes())}00`;
      const dtE = `${e.getFullYear()}${fmt2(e.getMonth()+1)}${fmt2(e.getDate())}T${fmt2(e.getHours())}${fmt2(e.getMinutes())}00`;
      const uid = `${data.slotId.replace(/[^A-Za-z0-9]+/g,'')}-${Date.now()}@alamass`;
      const desc = `Cours de natation privé (30 min). Piscine: ${data.pool}. Contact: ${data.phone}. * Arriver 10 min à l'avance.`;
      return `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//ALaRaMass//FR
CALSCALE:GREGORIAN
METHOD:PUBLISH
BEGIN:VEVENT
UID:${uid}
DTSTAMP:${dt}
DTSTART:${dt}
DTEND:${dtE}
SUMMARY:Cours de natation — À La Ra'Mass
DESCRIPTION:${desc}
LOCATION:${data.pool}
END:VEVENT
END:VCALENDAR`;
    }

    document.getElementById('dlIcs').addEventListener('click', ()=>{
      const bookings = loadBookings();
      const id = chosenSlotInput.dataset.slotId;
      const data = bookings[id] || Object.values(bookings).slice(-1)[0];
      if(!data){ return; }
      const ics = toICS(data);
      const blob = new Blob([ics], {type:'text/calendar'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = `reservation-alarmass-${Date.now()}.ics`;
      document.body.appendChild(a); a.click(); a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 5000);
    });

    // Paiement Stripe (mode test : lien fourni)
    const PAYMENT_LINK = 'https://buy.stripe.com/test_00w4gB9YfbBl6j26evaEE00';
    const DEMO_MODE = false;
    document.getElementById('payNow').addEventListener('click', ()=>{
      const bookings = loadBookings();
      const id = chosenSlotInput.dataset.slotId; const data = bookings[id];
      if(!data){ alert('Enregistrez d\'abord la réservation.'); return; }
      if(PAYMENT_LINK){
        const params = new URLSearchParams({ref:id,name:data.name,pool:data.pool,start:data.start,end:data.end,amount:'25.00'});
        window.location.href = `${PAYMENT_LINK}?${params.toString()}`;
      } else if (DEMO_MODE){
        alert('Mode démo : paiement simulé.'); data.paid = true; saveBookings(bookings);
      } else { alert('Paiement non configuré.'); }
    });

    // Navigation jours
    const tabsEls = document.querySelectorAll('.tab');
    tabsEls.forEach(t => t.addEventListener('click', ()=>{
      if(!t.dataset.day) return;
      tabsEls.forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      buildSlots(parseInt(t.dataset.day,10));
    }));
    extendWeek.addEventListener('change', ()=>{
      const active = document.querySelector('.tab.active');
      buildSlots(parseInt(active.dataset.day,10));
    });

    // Footer: année courante
    document.getElementById('year').textContent = new Date().getFullYear();

    // Init
    if(document.getElementById('pool')){ document.getElementById('pool').value = POOLS.currentPool?.name || POOLS['helios'].name; }
    buildSlots(1);

    // Effet bulles
    (function makeBubbles(){
      const root = document.getElementById('aquarium'); if(!root) return;
      const N = 28;
      for(let i=0;i<N;i++){
        const b = document.createElement('div'); b.className = 'bubble-fx';
        const size = Math.floor(10 + Math.random()*46);
        const x = Math.floor(Math.random()*100)+'%';
        const dur = (8 + Math.random()*16)+'s';
        const dx = (Math.random()<0.5?-1:1) * Math.floor(Math.random()*80) + 'px';
        b.style.setProperty('--s', size+'px');
        b.style.setProperty('--x', x);
        b.style.setProperty('--dur', dur);
        b.style.setProperty('--dx', dx);
        b.style.animationDelay = (Math.random()*10)+'s';
        root.appendChild(b);
      }
      root.addEventListener('animationiteration', (e)=>{
        const el = e.target;
        el.style.setProperty('--x', Math.floor(Math.random()*100)+'%');
        el.style.setProperty('--dur', (8 + Math.random()*16)+'s');
        el.style.setProperty('--s', (10 + Math.random()*46)+'px');
        el.style.setProperty('--dx', ((Math.random()<0.5?-1:1)*Math.floor(Math.random()*80))+'px');
      }, true);
    })();
  </script>
</body>
</html>
